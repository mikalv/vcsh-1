(use-package! "unit-test")

(define-test fast-io-lists-and-vectors
  (test-case (can-fast-io-round-trip? '()))
  (test-case (can-fast-io-round-trip? '(1)))
  (test-case (can-fast-io-round-trip? '(1 2)))
  (test-case (can-fast-io-round-trip? '(1 . 2)))
  (test-case (can-fast-io-round-trip? '(1 2 3)))
  (test-case (can-fast-io-round-trip? '(1 2 3 4 5 6 7 8 9 10)))
  (test-case (can-fast-io-round-trip? (make-list 260 #f)))

  (test-case (can-fast-io-round-trip? []))
  (test-case (can-fast-io-round-trip? [1]))
  (test-case (can-fast-io-round-trip? [1 2]))
  (test-case (can-fast-io-round-trip? [1 2 3]))
  (test-case (can-fast-io-round-trip? [1 2 3 4 5 6 7 8 9 10]))
  (test-case (can-fast-io-round-trip? (make-vector 260 #f)))

  (test-case (can-fast-io-round-trip? '(())))
  (test-case (can-fast-io-round-trip? '((1))))
  (test-case (can-fast-io-round-trip? '((1 2))))
  (test-case (can-fast-io-round-trip? '((1 . 2))))
  (test-case (can-fast-io-round-trip? '((1 2 3))))
  (test-case (can-fast-io-round-trip? '((1 2 3 4 5 6 7 8 9 10))))
  (test-case (can-fast-io-round-trip? (cons (make-list 260 #f))))

  (test-case (can-fast-io-round-trip? [[]]))
  (test-case (can-fast-io-round-trip? [[1]]))
  (test-case (can-fast-io-round-trip? [[1 2]]))
  (test-case (can-fast-io-round-trip? [[1 2 3]]))
  (test-case (can-fast-io-round-trip? [[1 2 3 4 5 6 7 8 9 10]]))
  (test-case (can-fast-io-round-trip? (vector (make-vector 260 #f))))

  (test-case (can-fast-io-round-trip? '([])))
  (test-case (can-fast-io-round-trip? '([1])))
  (test-case (can-fast-io-round-trip? '([1 2])))
  (test-case (can-fast-io-round-trip? '([1 2 3])))
  (test-case (can-fast-io-round-trip? '([1 2 3 4 5 6 7 8 9 10])))
  (test-case (can-fast-io-round-trip? (list (make-vector 260 #f))))

  (test-case (can-fast-io-round-trip? (vector '())))
  (test-case (can-fast-io-round-trip? (vector '(1))))
  (test-case (can-fast-io-round-trip? (vector '(1 2))))
  (test-case (can-fast-io-round-trip? (vector '(1 . 2))))
  (test-case (can-fast-io-round-trip? (vector '(1 2 3))))
  (test-case (can-fast-io-round-trip? (vector '(1 2 3 4 5 6 7 8 9 10))))

  (test-case (can-fast-io-round-trip? [[1] [2 3] [4 5 6] [7 8 9 10] [11 12 13 14 15]]))
  (test-case (can-fast-io-round-trip? '((1) (2 3) (4 5 6) (7 8 9 10) (11 12 13 14 15))))
  )
