(use-package! "unit-test")

(define-test let*
  (let ((side-effect-0 #f)
	(side-effect-1 #f)
	(side-effect-2 #f))
    (let* ((x 0)
	  (y 1)
	  (z 2))
      (set! side-effect-0 #t)
      (test-case (= x 0))
      (test-case (= y 1))
      (test-case (= z 2))
      (set! side-effect-1 #t)
      (set! x 10)
      (incr! y)
      (test-case (= x 10))
      (test-case (= y 2))
      (test-case (= z 2))
      (set! side-effect-2 #t))
    (test-case side-effect-0)
    (test-case side-effect-1)
    (test-case side-effect-2))

  (let ((x 10) 
	(y 20))
    (let* ((x 100)
	   (y x))
      (test-case (= x 100))
      (test-case (= y 100)))))

