(use-package! "unit-test")

(define-test list->filename
  (test-case (runtime-error? (list->filename 'foo)))
  (test-case (runtime-error? (list->filename 12)))
  (test-case (runtime-error? (list->filename '(12))))
  (test-case (runtime-error? (list->filename '(foo))))
  (test-case (runtime-error? (list->filename '(:crapola))))
  (test-case (runtime-error? (list->filename '("foo" :crapola "bar"))))
  (test-case (equal? (list->filename '()) ""))
  (test-case (equal? (list->filename '(" ")) " "))
  (test-case (equal? (list->filename '("foo")) "foo"))
  (test-case (equal? (list->filename '(" foo")) " foo"))
  (test-case (equal? (list->filename '("foo/")) "foo/"))
  (test-case (equal? (list->filename '("foo /")) "foo /"))
  (test-case (equal? (list->filename '(:absolute "foo")) "/foo"))
  (test-case (equal? (list->filename '(:absolute "foo/")) "/foo/"))
  (test-case (equal? (list->filename '("foo/" "bar")) "foo/bar"))
  (test-case (equal? (list->filename '("foo/" "bar/")) "foo/bar/"))
  (test-case (equal? (list->filename '(:absolute "foo/" "bar")) "/foo/bar"))
  (test-case (equal? (list->filename '(:absolute "foo/" "bar/")) "/foo/bar/"))
  (test-case (equal? (list->filename '(:absolute "foo/" " bar/")) "/foo/ bar/"))
  (test-case (equal? (list->filename '("foo/" "bar/" "baz/" "xyzzy/" "fubar/" "snafu/")) "foo/bar/baz/xyzzy/fubar/snafu/"))

  (test-case (equal? (list->filename '(:back "bar/")) "../bar/"))
  (test-case (equal? (list->filename '(:same-dir "bar/")) "bar/"))
  (test-case (equal? (list->filename '("foo/" :back "bar/")) "foo/../bar/"))
  (test-case (equal? (list->filename '("foo/" :same-dir "bar/")) "foo/bar/"))
  (test-case (equal? (list->filename '(:back)) "../"))
  (test-case (equal? (list->filename '(:back :delim)) "../"))
  (test-case (equal? (list->filename '(:back :same-dir)) "../"))
  (test-case (equal? (list->filename '(:absolute)) "/"))
  (test-case (equal? (list->filename '(:absolute :delim)) "/"))
  (test-case (equal? (list->filename '(:absolute :same-dir)) "/"))
  (test-case (equal? (list->filename '(:any-dirs :delim)) "**/"))
  (test-case (equal? (list->filename '(:any-dirs :same-dir)) "**/"))
  (test-case (equal? (list->filename '(:any-dirs :back)) "**/../"))
  (test-case (equal? (list->filename '(:absolute :any-dirs)) "/**/"))
  (test-case (equal? (list->filename '(:absolute :any-dirs :delim)) "/**/"))
  (test-case (equal? (list->filename '(:absolute :delim :delim :delim)) "/"))
  )
