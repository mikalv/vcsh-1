(use-package! "unit-test")

(define-test path-string->list
  (check (runtime-error? (path-string->list 12)))
  (check (runtime-error? (path-string->list :symbol)))
  (check (runtime-error? (path-string->list #t)))
  (check (equal? (path-string->list "") '()))
  (check (equal? (path-string->list ".") '(".")))
  (check (equal? (path-string->list "..") '("..")))
  (check (equal? (path-string->list "..:.") '(".." ".")))
  (check (equal? (path-string->list "..;.") '(".." ".")))
  (check (equal? (path-string->list ".:..") '("." "..")))
  (check (equal? (path-string->list ".;..") '("." "..")))
  (platform-case
   ((:linux)
    ;; Quoting doesn't work on *nix platforms
    (check (equal? (path-string->list ".\\:..") '(".:..")))
    (check (equal? (path-string->list ".\\;..") '(".;.."))))
   ((:win32)
    #t))
  (check (equal? (path-string->list "1;2;3;4") '("1" "2" "3" "4")))
  (check (equal? (path-string->list "1;.;..;4") '("1" "." ".." "4")))
  (check (equal? (path-string->list "./;..;~;/usr/lib/windmill") '("./" ".." "~" "/usr/lib/windmill")))
  (check (equal? (path-string->list "./;..;~;/usr/lib/windmill") '("./" ".." "~" "/usr/lib/windmill")))
  (check (equal? (path-string->list ";2;3;4") '("2" "3" "4")))
  (check (equal? (path-string->list "1;2;;4") '("1" "2" "4")))
  (check (equal? (path-string->list "1;2;3;") '("1" "2" "3")))
  (check (equal? (path-string->list "1;;;4") '("1" "4"))))
