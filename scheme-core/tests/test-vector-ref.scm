(use-package! "unit-test")

(define-test vector-ref
  (let ((a (vector :a :b :c :d :e)))
    (check (runtime-error? (vector-ref '(1 2 3 4) 2)))
    (check (runtime-error? (vector-ref a 'sym)))
    (check (runtime-error? (vector-ref a -1)))    
    (check (eq? :a (vector-ref a 0)))
    (check (eq? :a (vector-ref a 0.0)))
    (check (eq? :b (vector-ref a 1)))
    (check (eq? :c (vector-ref a 2)))
    (check (eq? :d (vector-ref a 3.0)))
    (check (eq? :e (vector-ref a 4)))
    (check (runtime-error? (vector-ref a 5)))
    (check (not (runtime-error? (vector-ref a -5 :default))))
    (check (eq? :default (vector-ref a -5 :default)))
    (check (not (runtime-error? (vector-ref a -5.0 :default))))
    (check (eq? :default (vector-ref a -5.0 :default)))
    (check (not (runtime-error? (vector-ref a 5 :default))))
    (check (eq? :default (vector-ref a 5 :default)))
    (check (not (runtime-error? (vector-ref a -5.0 :default))))
    (check (not (runtime-error? (vector-ref a 5.0 :default))))
    (check (eq? :default (vector-ref a -5.0 :default)))
    (check (eq? :default (vector-ref a 5.0 :default)))))
